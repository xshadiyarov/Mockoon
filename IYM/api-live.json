{
  "uuid": "ae508894-d79e-43cb-bf91-03c093c69e82",
  "lastMigration": 33,
  "name": "IYM - api-live",
  "endpointPrefix": "api-live",
  "latency": 0,
  "port": 3002,
  "hostname": "0.0.0.0",
  "folders": [],
  "routes": [
    {
      "uuid": "2cb2e59c-c3a7-45bf-b9ec-c613d9c6d421",
      "type": "http",
      "documentation": "",
      "method": "post",
      "endpoint": "v1/transfer/commission/",
      "responses": [
        {
          "uuid": "7ffd0bfc-1230-43f0-bbe1-a125fd57f18c",
          "body": "{}",
          "latency": 0,
          "statusCode": 400,
          "label": "",
          "headers": [],
          "bodyType": "DATABUCKET",
          "filePath": "",
          "databucketID": "joc1",
          "sendFileAsBody": false,
          "rules": [],
          "rulesOperator": "OR",
          "disableTemplating": false,
          "fallbackTo404": false,
          "default": true,
          "crudKey": "id",
          "callbacks": []
        },
        {
          "uuid": "54750325-cc42-4ecd-a327-88584a10a0ca",
          "body": "{{setVar 'amount' (body 'amount')}}\r\n\r\n{{#switch (body 'source.type')}}\r\n  {{#case 'card'}}\r\n    {{setVar 'left' 'p'}}\r\n  {{/case}}\r\n  {{#case 'account'}}\r\n    {{setVar 'left' 'a'}}\r\n  {{/case}}\r\n  {{#case 'wallet'}}\r\n    {{setVar 'left' 'w'}}\r\n  {{/case}}\r\n  {{#default}}\r\n    {{setVar 'left' 'p'}}\r\n  {{/default}}\r\n{{/switch}}\r\n\r\n{{#switch (body 'destination.type')}}\r\n  {{#case 'card'}}\r\n    {{setVar 'right' 'p'}}\r\n  {{/case}}\r\n  {{#case 'pan'}}\r\n    {{setVar 'right' 'p'}}\r\n  {{/case}}\r\n  {{#case 'account'}}\r\n    {{setVar 'right' 'a'}}\r\n  {{/case}}\r\n  {{#case 'wallet'}}\r\n    {{setVar 'right' 'w'}}\r\n  {{/case}}\r\n  {{#default}}\r\n    {{setVar 'right' 'p'}}\r\n  {{/default}}\r\n{{/switch}}\r\n\r\n{{setVar 'type' (concat (getVar 'left') 2 (getVar 'right'))}}\r\n\r\n{{#switch (getVar 'type')}}\r\n  {{#case 'p2p'}}\r\n    {{setVar 'type' (oneOf (array 'p2p' 'pcv' 'vcp' 'v2v'))}}\r\n  {{/case}}\r\n  {{#case 'p2a'}}\r\n    {{setVar 'type' (oneOf (array 'p2a' 'v2a'))}}\r\n  {{/case}}\r\n  {{#case 'a2p'}}\r\n    {{setVar 'type' (oneOf (array 'a2p' 'a2v'))}}\r\n  {{/case}}\r\n{{/switch}}\r\n\r\n{{setVar 'state' 'preflight'}}\r\n{{#if (includes 'p2p p2a p2w pcv' (getVar 'type'))}}\r\n  {{setVar 'state' (oneOf (array 'own' 'credit' 'own_credit'))}}\r\n{{else}}\r\n  {{setVar 'state' 'own'}}\r\n{{/if}}\r\n\r\n{{#switch (getVar 'type')}}\r\n  {{#case 'v2v'}}\r\n    {{setVar 'currency' 'USD'}}\r\n  {{/case}}\r\n  {{#case 'pcv'}}\r\n    {{setVar 'currency' 'USD'}}\r\n  {{/case}}\r\n  {{#case 'v2a'}}\r\n    {{setVar 'currency' 'USD'}}\r\n  {{/case}}\r\n  {{#case 'a2a'}}\r\n    {{setVar 'currency' (oneOf (array 'UZS' 'USD'))}}\r\n  {{/case}}\r\n  {{#case 'w2a'}}\r\n    {{setVar 'currency' (oneOf (array 'UZS' 'USD'))}}\r\n  {{/case}}\r\n  {{#case 'a2v'}}\r\n    {{setVar 'currency' (oneOf (array 'UZS' 'USD'))}}\r\n  {{/case}}\r\n  {{#default}}\r\n    {{setVar 'currency' 'UZS'}}\r\n  {{/default}}\r\n{{/switch}}\r\n\r\n{{#switch (getVar 'state')}}\r\n  {{#case 'own_credit'}}\r\n    {{setVar 'own_fee' (parseInt (divide (multiply (getVar 'amount') '5') '2000'))}}\r\n    {{setVar 'credit_fee' (parseInt (divide (multiply (getVar 'amount') '25') '2000'))}}\r\n    {{setVar 'fee' (add (getVar 'own_fee') (getVar 'credit_fee'))}}\r\n    {{setVar 'funds_own_amount' (divide (getVar 'amount') '2')}}\r\n    {{setVar 'funds_credit_amount' (divide (getVar 'amount') '2')}}\r\n    {{setVar 'funds_own_fee' (getVar 'own_fee')}}\r\n    {{setVar 'funds_credit_fee' (getVar 'credit_fee')}}\r\n  {{/case}}\r\n  {{#case 'own'}}\r\n    {{setVar 'fee' (floor (divide (multiply (getVar 'amount') '5') '1000'))}}\r\n    {{setVar 'funds_own_amount' (getVar 'amount')}}\r\n    {{setVar 'funds_own_fee' (getVar 'fee')}}\r\n  {{/case}}\r\n  {{#case 'credit'}}\r\n    {{setVar 'fee' (floor (divide (multiply (getVar 'amount') '25') '1000'))}}\r\n    {{setVar 'funds_credit_amount' (getVar 'amount')}}\r\n    {{setVar 'funds_credit_fee' (getVar 'fee')}}\r\n  {{/case}}\r\n{{/switch}}\r\n{{setVar 'total' (add (getVar 'amount') (getVar 'fee'))}}\r\n\r\n{{#if (includes 'pcv vcp' (getVar 'type'))}}\r\n  {{setVar 'include_fee' 'false'}}\r\n{{else}}\r\n  {{setVar 'include_fee' (body 'include_fee')}}\r\n{{/if}}\r\n{{#switch (getVar 'state')}}\r\n  {{#case 'own'}}\r\n    {{setVar 'include_fee_right' '1005'}}\r\n  {{/case}}\r\n  {{#case 'credit'}}\r\n    {{setVar 'include_fee_right' '1025'}}\r\n  {{/case}}\r\n{{/switch}}\r\n{{setVar 'include_fee_weight' '1000'}}\r\n{{#if (getVar 'fee')}}\r\n  {{#switch (getVar 'state')}}\r\n    {{#case 'own_credit'}}{{/case}}\r\n    {{#default}}\r\n      {{#if (eq (getVar 'include_fee') 'true')}}\r\n        {{setVar 'total' (getVar 'amount')}}\r\n        {{setVar 'amount' (round (multiply (divide (getVar 'amount') (getVar 'include_fee_right')) (getVar 'include_fee_weight')))}}\r\n        {{setVar 'fee' (floor (subtract (getVar 'total') (getVar 'amount')))}}\r\n        {{#if (getVar 'funds_credit_amount')}}\r\n          {{setVar 'funds_credit_amount' (getVar 'amount')}}\r\n          {{setVar 'funds_credit_fee' (getVar 'fee')}}\r\n        {{/if}}\r\n        {{#if (getVar 'funds_own_amount')}}\r\n          {{setVar 'funds_own_amount' (getVar 'amount')}}\r\n          {{setVar 'funds_own_fee' (getVar 'fee')}}\r\n        {{/if}}\r\n      {{/if}}\r\n    {{/default}}\r\n  {{/switch}}\r\n{{/if}}\r\n\r\n{{#if (eq (getVar 'type') 'p2p')}}\r\n  {{setVar 'limit_state' (oneOf (array 'full' 'part_used' 'overlimit' 'full_used' 'no_limit'))}}\r\n{{/if}}\r\n{{setVar 'limit_max' '1000000000'}}\r\n{{#switch (getVar 'limit_state')}}\r\n  {{#case 'full_used'}}\r\n    {{setVar 'limit_used' (getVar 'limit_max')}}\r\n  {{/case}}\r\n  {{#case 'full'}}\r\n    {{setVar 'limit_used' '0'}}\r\n  {{/case}}\r\n  {{#default}}\r\n    {{setVar 'limit_used' (divide (getVar 'limit_max') '2')}}\r\n  {{/default}}\r\n{{/switch}}\r\n\r\n{{#if (eq (getVar 'type') 'p2p')}}\r\n  {{setVar 'is_limit' (oneOf (array true false))}}\r\n{{/if}}\r\n\r\n{\r\n  \"data\": {\r\n      \"state\": \"{{getVar 'state'}}\",\r\n      \"currency\": \"{{getVar 'currency'}}\",\r\n      \"total\":\r\n        {{#switch (getVar 'state')}}\r\n          {{#case 'preflight'}}null{{/case}}\r\n          {{#default}}\r\n            {\r\n              \"total\": {{getVar 'total'}},\r\n              \"amount\": {{getVar 'amount'}},\r\n              \"fee\": {{getVar 'fee'}}\r\n            }\r\n          {{/default}}\r\n        {{/switch}},\r\n      \"funds\":\r\n        {{#switch (getVar 'state')}}\r\n          {{#case 'preflight'}}null{{/case}}\r\n          {{#default}}\r\n            {\r\n              \"own\":\r\n                {{#switch (getVar 'state')}}\r\n                  {{#case 'credit'}}null{{/case}}\r\n                  {{#default}}\r\n                    {\r\n                      \"amount\": {{getVar 'funds_own_amount'}},\r\n                      \"percent\": 0.5,\r\n                      \"fee\": {{getVar 'funds_own_fee'}}\r\n                    }\r\n                  {{/default}}\r\n                {{/switch}},\r\n              \"credit\":\r\n                {{#switch (getVar 'state')}}\r\n                  {{#case 'own'}}null{{/case}}\r\n                  {{#default}}\r\n                    {\r\n                      \"amount\": {{getVar 'funds_credit_amount'}},\r\n                      \"percent\": 2.5,\r\n                      \"fee\": {{getVar 'funds_credit_fee'}}\r\n                    }\r\n                  {{/default}}\r\n                {{/switch}}\r\n            }\r\n          {{/default}}\r\n        {{/switch}},\r\n      \"limit\":\r\n        {{#if (getVar 'is_limit')}}\r\n          {\r\n            \"state\": \"{{getVar 'limit_state'}}\",\r\n            \"period\": \"До 1 Марта 2025\",\r\n            \"min\": null,\r\n            \"max\": {{getVar 'limit_max'}},\r\n            \"used\": {{getVar 'limit_used'}}\r\n          }\r\n        {{else}}\r\n          null\r\n        {{/if}},\r\n      \"amounts\": [\r\n        100000,\r\n        123400,\r\n        200000\r\n      ]\r\n  },\r\n  \"state\": \"success\",\r\n  \"error_text\": \"\",\r\n  \"code\": 0,\r\n  \"_mockoon\": {\r\n    \"type\": \"{{getVar 'type'}}\",\r\n    \"state\": \"{{getVar 'state'}}\"\r\n  }\r\n}",
          "latency": 0,
          "statusCode": 200,
          "label": "",
          "headers": [],
          "bodyType": "INLINE",
          "filePath": "",
          "databucketID": "",
          "sendFileAsBody": false,
          "rules": [
            {
              "target": "body",
              "modifier": "source.type",
              "value": "^(card|account|wallet)$",
              "invert": false,
              "operator": "regex"
            },
            {
              "target": "body",
              "modifier": "destination.type",
              "value": "^(card|account|wallet|pan)$",
              "invert": false,
              "operator": "regex"
            },
            {
              "target": "body",
              "modifier": "source.id",
              "value": "^[1-9]+$",
              "invert": false,
              "operator": "regex"
            },
            {
              "target": "body",
              "modifier": "destination.id",
              "value": "^[1-9]+$",
              "invert": false,
              "operator": "regex"
            }
          ],
          "rulesOperator": "AND",
          "disableTemplating": false,
          "fallbackTo404": false,
          "default": false,
          "crudKey": "id",
          "callbacks": []
        }
      ],
      "responseMode": null,
      "streamingMode": null,
      "streamingInterval": 0
    },
    {
      "uuid": "e484904d-0722-4832-b9b9-91ae4694b4c4",
      "type": "http",
      "documentation": "",
      "method": "post",
      "endpoint": "v1/transfer/prepayment/",
      "responses": [
        {
          "uuid": "e3de6cbc-93c2-4dfa-9fb7-1046a53d1fe3",
          "body": "",
          "latency": 0,
          "statusCode": 400,
          "label": "",
          "headers": [],
          "bodyType": "DATABUCKET",
          "filePath": "",
          "databucketID": "joc1",
          "sendFileAsBody": false,
          "rules": [],
          "rulesOperator": "OR",
          "disableTemplating": false,
          "fallbackTo404": false,
          "default": true,
          "crudKey": "id",
          "callbacks": []
        },
        {
          "uuid": "e83374e7-8a42-4d86-a606-05aee52f253c",
          "body": "{{setVar 'request_id' (body 'id')}}\n\n{{#if (getVar 'request_id')}}\n  {{setVar 'id' (getVar 'request_id')}}\n{{else}}\n  {{setVar 'id' 'some#@!1.-\\$hash'}}\n{{/if}}\n\n{{setVar 'is_error' (oneOf (array false false false false false false false false false true))}}\n{{#if (getVar 'is_error')}}\n  {{#if (getVar 'request_id')}}\n    {{setVar 'error' (oneOf (array 'otp_ttl_not_expired' 'otp_ttl_not_expired' 'otp_ttl_not_expired' 'transfer_state_expired'))}}\n  {{else}}\n    {{setVar 'error' 'transfer_state_expired'}}\n  {{/if}}\n{{/if}}\n{{#switch (getVar 'error')}}\n  {{#case 'otp_ttl_not_expired'}}\n    {{setVar 'error_text' 'Время на повторную отправку кода подтверждения еще не пришло.'}}\n  {{/case}}\n  {{#case 'transfer_state_expired'}}\n    {{setVar 'error_text' 'Время на совершение платежа истекло. Пожалуйста повторите платеж.'}}\n  {{/case}}\n{{/switch}}\n{{setVar 'error_text' (concat (getVar 'error_text') ' ' '(ID: 1s32wiynk)')}}\n\n{{#if (gt (body 'amount') '0')}}\n  {{setVar 'amount' (body 'amount')}}\n{{else}}\n  {{setVar 'amount' '100000'}}\n{{/if}}\n\n{{setVar 'comment' (body 'comment')}}\n\n{{#switch (body 'source.type')}}\n  {{#case 'card'}}\n    {{setVar 'left' 'p'}}\n  {{/case}}\n  {{#case 'account'}}\n    {{setVar 'left' 'a'}}\n  {{/case}}\n  {{#case 'wallet'}}\n    {{setVar 'left' 'w'}}\n  {{/case}}\n  {{#default}}\n    {{setVar 'left' 'p'}}\n  {{/default}}\n{{/switch}}\n\n{{#switch (body 'destination.type')}}\n  {{#case 'card'}}\n    {{setVar 'right' 'p'}}\n  {{/case}}\n  {{#case 'pan'}}\n    {{setVar 'right' 'p'}}\n  {{/case}}\n  {{#case 'account'}}\n    {{setVar 'right' 'a'}}\n  {{/case}}\n  {{#case 'wallet'}}\n    {{setVar 'right' 'w'}}\n  {{/case}}\n  {{#default}}\n    {{setVar 'right' 'p'}}\n  {{/default}}\n{{/switch}}\n\n{{setVar 'type' (concat (getVar 'left') 2 (getVar 'right'))}}\n\n{{#switch (getVar 'type')}}\n  {{#case 'p2p'}}\n    {{setVar 'type' (oneOf (array 'p2p' 'pcv' 'vcp' 'v2v'))}}\n  {{/case}}\n  {{#case 'p2a'}}\n    {{setVar 'type' (oneOf (array 'p2a' 'v2a'))}}\n  {{/case}}\n  {{#case 'a2p'}}\n    {{setVar 'type' (oneOf (array 'a2p' 'a2v'))}}\n  {{/case}}\n{{/switch}}\n\n{{setVar 'state' 'own'}}\n{{#if (includes 'p2p p2a p2w pcv' (getVar 'type'))}}\n  {{setVar 'state' (oneOf (array 'own' 'credit' 'own_credit'))}}\n{{/if}}\n\n{{#switch (getVar 'right')}}\n  {{#case 'p'}}\n    {{setVar 'additional_header_title' 'Перевод на карту'}}\n  {{/case}}\n  {{#case 'a'}}\n    {{setVar 'additional_header_title' 'Перевод на счет'}}\n  {{/case}}\n  {{#case 'w'}}\n    {{setVar 'additional_header_title' 'Перевод на кошелек'}}\n  {{/case}}\n{{/switch}}\n\n{{setVar 'additional_icon_light' 'https://storage.googleapis.com/iyb-mobile-app-front/api-live/images/icons/1661f68528c6fb.png'}}\n\n{{#switch (getVar 'type')}}\n  {{#case 'v2v'}}\n    {{setVar 'currency' 'USD'}}\n  {{/case}}\n  {{#case 'pcv'}}\n    {{setVar 'currency' 'USD'}}\n  {{/case}}\n  {{#case 'v2a'}}\n    {{setVar 'currency' 'USD'}}\n  {{/case}}\n  {{#case 'a2a'}}\n    {{setVar 'currency' (oneOf (array 'UZS' 'USD'))}}\n  {{/case}}\n  {{#case 'w2a'}}\n    {{setVar 'currency' (oneOf (array 'UZS' 'USD'))}}\n  {{/case}}\n  {{#case 'a2v'}}\n    {{setVar 'currency' (oneOf (array 'UZS' 'USD'))}}\n  {{/case}}\n  {{#default}}\n    {{setVar 'currency' 'UZS'}}\n  {{/default}}\n{{/switch}}\n\n{{#switch (getVar 'state')}}\n  {{#case 'own_credit'}}\n    {{setVar 'own_fee' (parseInt (divide (multiply (getVar 'amount') '5') '2000'))}}\n    {{setVar 'credit_fee' (parseInt (divide (multiply (getVar 'amount') '25') '2000'))}}\n    {{setVar 'fee' (add (getVar 'own_fee') (getVar 'credit_fee'))}}\n  {{/case}}\n  {{#case 'own'}}\n    {{#if (eq (getVar 'type') 'p2p')}}\n      {{setVar 'fee' (floor (divide (multiply (getVar 'amount') '5') '1000'))}}\n    {{else}}\n      {{setVar 'fee' '0'}}\n    {{/if}}\n  {{/case}}\n  {{#case 'credit'}}\n    {{setVar 'fee' (floor (divide (multiply (getVar 'amount') '25') '1000'))}}\n  {{/case}}\n{{/switch}}\n\n{{#if (includes 'pcv vcp' (getVar 'type'))}}\n  {{setVar 'include_fee' 'false'}}\n{{else}}\n  {{setVar 'include_fee' (body 'include_fee')}}\n{{/if}}\n{{#switch (getVar 'state')}}\n  {{#case 'own'}}\n    {{setVar 'include_fee_right' '1005'}}\n  {{/case}}\n  {{#case 'credit'}}\n    {{setVar 'include_fee_right' '1025'}}\n  {{/case}}\n{{/switch}}\n{{setVar 'include_fee_weight' '1000'}}\n{{#if (gt (getVar 'fee') '0')}}\n  {{#switch (getVar 'state')}}\n    {{#case 'own_credit'}}{{/case}}\n    {{#default}}\n      {{#if (eq (getVar 'include_fee') 'true')}}\n        {{setVar '_amount' (getVar 'amount')}}\n        {{setVar 'amount' (round (multiply (divide (getVar 'amount') (getVar 'include_fee_right')) (getVar 'include_fee_weight')))}}\n        {{setVar 'fee' (floor (subtract (getVar '_amount') (getVar 'amount')))}}\n      {{/if}}\n    {{/default}}\n  {{/switch}}\n{{/if}}\n\n{{setVar 'additional_footer_value' (add (getVar 'amount') (getVar 'fee'))}}\n\n{{setVar 'self_confirm_code' (oneOf (array '' '123456'))}}\n\n{{setData 'set' 'additional_items' '' (array)}}\n\n{{setData 'push' 'additional_items' '' (object key='Дата' value=(now 'dd.MM.yyyy'))}}\n\n{{setVar 'is_from_card' (includes 'p2p p2a v2a p2w pcv vcp v2v' (getVar 'type'))}}\n{{setVar 'item_icon_uzcard' 'https://storage.googleapis.com/iyb-mobile-app-front/api-live/images/icons/165e5bb4c2c3ba.png'}}\n{{#if (getVar 'is_from_card')}}\n  {{setData 'push' 'additional_items' '' (object key='С карты' value='**** 7495' icon=(object light=(getVar 'item_icon_uzcard') dark='null'))}}\n{{/if}}\n\n{{setVar 'is_from_account' (includes 'a2a a2p a2w a2v' (getVar 'type'))}}\n{{#if (getVar 'is_from_account')}}\n  {{setData 'push' 'additional_items' '' (object key='Со счета' value='20206000********7400')}}\n{{/if}}\n\n{{setVar 'is_from_wallet' (includes 'w2a w2p w2w' (getVar 'type'))}}\n{{#if (getVar 'is_from_wallet')}}\n  {{setData 'push' 'additional_items' '' (object key='С кошелька' value='20206000********7400')}}\n{{/if}}\n\n{{setVar 'is_to_card' (includes 'p2p w2p a2p pcv vcp v2v a2v' (getVar 'type'))}}\n{{#if (getVar 'is_to_card')}}\n  {{setData 'push' 'additional_items' '' (object key='На карту' value='**** 6616' icon=(object light=(getVar 'item_icon_uzcard') dark='null'))}}\n{{/if}}\n\n{{setVar 'is_to_account' (includes 'p2a v2a a2a w2a' (getVar 'type'))}}\n{{#if (getVar 'is_to_account')}}\n  {{setData 'push' 'additional_items' '' (object key='На счет' value='20206000********7400')}}\n{{/if}}\n\n{{setVar 'is_to_wallet' (includes 'a2w p2w w2w' (getVar 'type'))}}\n{{#if (getVar 'is_to_wallet')}}\n  {{setData 'push' 'additional_items' '' (object key='На кошелек' value='20206000********7400')}}\n{{/if}}\n\n{{setData 'push' 'additional_items' '' (object key='Получатель' value='XASAN SHADIYAROV')}}\n\n{{#if (getVar 'comment')}}\n  {{setVar 'is_comment' (includes 'p2p w2p a2p pcv vcp v2v a2v' (getVar 'type'))}}\n{{/if}}\n{{#if (getVar 'is_comment')}}\n  {{setData 'push' 'additional_items' '' (object key='Комментарий' value=(getVar 'comment'))}}\n{{/if}}\n\n{{setData 'push' 'additional_items' '' (object key='Сумма к получению' value=(concat (divide (getVar 'amount') 100) ' ' (getVar 'currency')))}}\n\n{{#switch (getVar 'state')}}\n  {{#case 'own_credit'}}\n    {{setData 'push' 'additional_items' '' (object key='Комиссия с собственных средств' value=(concat (divide (getVar 'own_fee') 100) ' ' (getVar 'currency')))}}\n    {{setData 'push' 'additional_items' '' (object key='Комиссия с кредитных средств' value=(concat (divide (getVar 'credit_fee') 100) ' ' (getVar 'currency')))}}\n  {{/case}}\n  {{#default}}\n    {{setData 'push' 'additional_items' '' (object key='Комиссия' value=(concat (divide (getVar 'fee') 100) ' ' (getVar 'currency')))}}\n  {{/default}}\n{{/switch}}\n\n{{setVar 'self_transfer' (oneOf (array true false false false false false false false false false))}}\n\n{\n  \"data\":\n    {{#if (getVar 'is_error')}}\n      {}\n    {{else}}\n      {\n        \"id\": \"{{getVar 'id'}}\",\n        \"ttl\": 300,\n        \"ttl_at\": {{now 't'}},\n        \"additional\": {\n          \"header\": {\n            \"title\": \"{{getVar 'additional_header_title'}}\",\n            \"icon\": {\n              \"light\": \"{{getVar 'additional_icon_light'}}\",\n              \"dark\": null\n            }\n          },\n          \"footer\": {\n            \"title\": \"Итого\",\n            \"value\": \"{{divide (getVar 'additional_footer_value') 100}} {{getVar 'currency'}}\"\n          },\n          \"items\": [\n            {{#each (dataRaw 'additional_items')}}\n              {\n                \"key\": \"{{this.key}}\",\n                \"value\": \"{{this.value}}\",\n                \"icon\":\n                  {{#if this.icon}}\n                    {\n                      \"light\": \"{{this.icon.light}}\",\n                      \"dark\": null\n                    }\n                  {{else}}\n                    null\n                  {{/if}}\n              }{{#unless @last}},{{/unless}}\n            {{/each}}\n          ]\n        },\n        \"self\": {\n          \"confirm\": {\n            \"phone\": \"99897*****17\",\n            \"code\":\n              {{#if (getVar 'self_confirm_code')}}\n                \"{{getVar 'self_confirm_code'}}\"\n              {{else}}\n                null\n              {{/if}},\n            \"ttl\": 60,\n            \"ttl_at\": {{now 't'}}\n          },\n          \"transfer\": {{getVar 'self_transfer'}}\n        }\n      }\n    {{/if}},\n  \"state\":\n    {{#if (getVar 'is_error')}}\n      \"error\"\n    {{else}}\n      \"success\"\n    {{/if}},\n  \"error_text\":\n    {{#if (getVar 'is_error')}}\n      \"{{getVar 'error_text'}}\"\n    {{else}}\n      \"\"\n    {{/if}},\n  \"code\": 0,\n  \"_mockoon\": {\n    \"type\": \"{{getVar 'type'}}\",\n    \"state\": \"{{getVar 'state'}}\"\n  }\n}",
          "latency": 0,
          "statusCode": 200,
          "label": "",
          "headers": [],
          "bodyType": "INLINE",
          "filePath": "",
          "databucketID": "",
          "sendFileAsBody": false,
          "rules": [
            {
              "target": "body",
              "modifier": "source.type",
              "value": "^(card|account|wallet)$",
              "invert": false,
              "operator": "regex"
            },
            {
              "target": "body",
              "modifier": "destination.type",
              "value": "^(card|account|wallet|pan)$",
              "invert": false,
              "operator": "regex"
            },
            {
              "target": "body",
              "modifier": "source.id",
              "value": "^[1-9]+$",
              "invert": false,
              "operator": "regex"
            },
            {
              "target": "body",
              "modifier": "destination.id",
              "value": "^[1-9]+$",
              "invert": false,
              "operator": "regex"
            }
          ],
          "rulesOperator": "AND",
          "disableTemplating": false,
          "fallbackTo404": false,
          "default": false,
          "crudKey": "id",
          "callbacks": []
        }
      ],
      "responseMode": null,
      "streamingMode": null,
      "streamingInterval": 0
    },
    {
      "uuid": "d8300476-ada9-46a4-8ec8-abb964df5d2a",
      "type": "http",
      "documentation": "",
      "method": "post",
      "endpoint": "v1/transfer/payment/",
      "responses": [
        {
          "uuid": "78d496fe-b13a-4b1c-97cc-555611c9c035",
          "body": "{}",
          "latency": 0,
          "statusCode": 400,
          "label": "",
          "headers": [],
          "bodyType": "DATABUCKET",
          "filePath": "",
          "databucketID": "joc1",
          "sendFileAsBody": false,
          "rules": [],
          "rulesOperator": "OR",
          "disableTemplating": false,
          "fallbackTo404": false,
          "default": true,
          "crudKey": "id",
          "callbacks": []
        },
        {
          "uuid": "6fade370-c2e8-4210-8582-34107c5f3208",
          "body": "{{setVar 'code' (body 'code')}}\n{{setVar 'amount' '100000'}}\n{{setVar 'comment' 'Здесь какой-то коммент'}}\n\n{{setVar 'is_error' (oneOf (array false false false false false false false false false true))}}\n{{#if (getVar 'is_error')}}\n  {{setVar 'error' (oneOf (array 'no_trans_type' 'no_trans_service' 'otp_ttl_expired'))}}\n{{/if}}\n{{#switch (getVar 'error')}}\n  {{#case 'no_trans_type'}}\n    {{setVar 'error_text' 'Тип транзакции не найден.'}}\n  {{/case}}\n  {{#case 'no_trans_service'}}\n    {{setVar 'error_text' 'Тип транзакции временно недоступен.'}}\n  {{/case}}\n  {{#case 'otp_ttl_expired'}}\n    {{setVar 'error_text' 'Срок жизни СМС кода истек, пожалуйста запросите новый.'}}\n  {{/case}}\n{{/switch}}\n{{setVar 'error_text' (concat (getVar 'error_text') ' ' '(ID: 1s32wiynk)')}}\n\n{{setVar 'left' (oneOf (array 'p' 'a' 'w' 'p'))}}\n{{setVar 'right' (oneOf (array 'p' 'p' 'a' 'w' 'p'))}}\n\n{{setVar 'type' (concat (getVar 'left') 2 (getVar 'right'))}}\n\n{{#switch (getVar 'type')}}\n  {{#case 'p2p'}}\n    {{setVar 'type' (oneOf (array 'p2p' 'pcv' 'vcp' 'v2v'))}}\n  {{/case}}\n  {{#case 'p2a'}}\n    {{setVar 'type' (oneOf (array 'p2a' 'v2a'))}}\n  {{/case}}\n  {{#case 'a2p'}}\n    {{setVar 'type' (oneOf (array 'a2p' 'a2v'))}}\n  {{/case}}\n{{/switch}}\n\n{{setVar 'state' 'own'}}\n{{#if (includes 'p2p p2a p2w pcv' (getVar 'type'))}}\n  {{setVar 'state' (oneOf (array 'own' 'credit' 'own_credit'))}}\n{{/if}}\n\n{{#switch (getVar 'right')}}\n  {{#case 'p'}}\n    {{setVar 'additional_header_title' 'Перевод на карту'}}\n  {{/case}}\n  {{#case 'a'}}\n    {{setVar 'additional_header_title' 'Перевод на счет'}}\n  {{/case}}\n  {{#case 'w'}}\n    {{setVar 'additional_header_title' 'Перевод на кошелек'}}\n  {{/case}}\n{{/switch}}\n\n{{setVar 'additional_icon_light' 'https://storage.googleapis.com/iyb-mobile-app-front/api-live/images/icons/1661f68528c6fb.png'}}\n\n{{#switch (getVar 'type')}}\n  {{#case 'v2v'}}\n    {{setVar 'currency' 'USD'}}\n  {{/case}}\n  {{#case 'pcv'}}\n    {{setVar 'currency' 'USD'}}\n  {{/case}}\n  {{#case 'v2a'}}\n    {{setVar 'currency' 'USD'}}\n  {{/case}}\n  {{#case 'a2a'}}\n    {{setVar 'currency' (oneOf (array 'UZS' 'USD'))}}\n  {{/case}}\n  {{#case 'w2a'}}\n    {{setVar 'currency' (oneOf (array 'UZS' 'USD'))}}\n  {{/case}}\n  {{#case 'a2v'}}\n    {{setVar 'currency' (oneOf (array 'UZS' 'USD'))}}\n  {{/case}}\n  {{#default}}\n    {{setVar 'currency' 'UZS'}}\n  {{/default}}\n{{/switch}}\n\n{{#switch (getVar 'state')}}\n  {{#case 'own_credit'}}\n    {{setVar 'own_fee' (parseInt (divide (multiply (getVar 'amount') '5') '2000'))}}\n    {{setVar 'credit_fee' (parseInt (divide (multiply (getVar 'amount') '25') '2000'))}}\n    {{setVar 'fee' (add (getVar 'own_fee') (getVar 'credit_fee'))}}\n  {{/case}}\n  {{#case 'own'}}\n    {{#if (eq (getVar 'type') 'p2p')}}\n      {{setVar 'fee' (floor (divide (multiply (getVar 'amount') '5') '1000'))}}\n    {{else}}\n      {{setVar 'fee' '0'}}\n    {{/if}}\n  {{/case}}\n  {{#case 'credit'}}\n    {{setVar 'fee' (floor (divide (multiply (getVar 'amount') '25') '1000'))}}\n  {{/case}}\n{{/switch}}\n{{setVar 'additional_footer_value' (add (getVar 'amount') (getVar 'fee'))}}\n\n{{setData 'set' 'additional_items' '' (array)}}\n\n{{setData 'push' 'additional_items' '' (object key='Дата' value=(now 'dd.MM.yyyy'))}}\n\n{{setVar 'is_from_card' (includes 'p2p p2a v2a p2w pcv vcp v2v' (getVar 'type'))}}\n{{setVar 'item_icon_uzcard' 'https://storage.googleapis.com/iyb-mobile-app-front/api-live/images/icons/165e5bb4c2c3ba.png'}}\n{{#if (getVar 'is_from_card')}}\n  {{setData 'push' 'additional_items' '' (object key='С карты' value='**** 7495' icon=(object light=(getVar 'item_icon_uzcard') dark='null'))}}\n{{/if}}\n\n{{setVar 'is_from_account' (includes 'a2a a2p a2w a2v' (getVar 'type'))}}\n{{#if (getVar 'is_from_account')}}\n  {{setData 'push' 'additional_items' '' (object key='Со счета' value='20206000********7400')}}\n{{/if}}\n\n{{setVar 'is_from_wallet' (includes 'w2a w2p w2w' (getVar 'type'))}}\n{{#if (getVar 'is_from_wallet')}}\n  {{setData 'push' 'additional_items' '' (object key='С кошелька' value='20206000********7400')}}\n{{/if}}\n\n{{setVar 'is_to_card' (includes 'p2p w2p a2p pcv vcp v2v a2v' (getVar 'type'))}}\n{{#if (getVar 'is_to_card')}}\n  {{setData 'push' 'additional_items' '' (object key='На карту' value='**** 6616' icon=(object light=(getVar 'item_icon_uzcard') dark='null'))}}\n{{/if}}\n\n{{setVar 'is_to_account' (includes 'p2a v2a a2a w2a' (getVar 'type'))}}\n{{#if (getVar 'is_to_account')}}\n  {{setData 'push' 'additional_items' '' (object key='На счет' value='20206000********7400')}}\n{{/if}}\n\n{{setVar 'is_to_wallet' (includes 'a2w p2w w2w' (getVar 'type'))}}\n{{#if (getVar 'is_to_wallet')}}\n  {{setData 'push' 'additional_items' '' (object key='На кошелек' value='20206000********7400')}}\n{{/if}}\n\n{{setData 'push' 'additional_items' '' (object key='Получатель' value='XASAN SHADIYAROV')}}\n\n{{#if (getVar 'comment')}}\n  {{setVar 'is_comment' (includes 'p2p w2p a2p pcv vcp v2v a2v' (getVar 'type'))}}\n{{/if}}\n{{#if (getVar 'is_comment')}}\n  {{setData 'push' 'additional_items' '' (object key='Комментарий' value=(getVar 'comment'))}}\n{{/if}}\n\n{{setData 'push' 'additional_items' '' (object key='Сумма к получению' value=(concat (divide (getVar 'amount') 100) ' ' (getVar 'currency')))}}\n\n{{#switch (getVar 'state')}}\n  {{#case 'own_credit'}}\n    {{setData 'push' 'additional_items' '' (object key='Комиссия с собственных средств' value=(concat (divide (getVar 'own_fee') 100) ' ' (getVar 'currency')))}}\n    {{setData 'push' 'additional_items' '' (object key='Комиссия с кредитных средств' value=(concat (divide (getVar 'credit_fee') 100) ' ' (getVar 'currency')))}}\n  {{/case}}\n  {{#default}}\n    {{setData 'push' 'additional_items' '' (object key='Комиссия' value=(concat (divide (getVar 'fee') 100) ' ' (getVar 'currency')))}}\n  {{/default}}\n{{/switch}}\n\n{\n  \"data\": \n    {{#if (getVar 'is_error')}}\n      {},\n    {{else}}\n      {\n        \"state\": \"complete\",\n        \"id\": {{int 11111111 99999999}},\n        \"additional\": {\n          \"header\": {\n            \"title\": \"{{getVar 'additional_header_title'}}\",\n            \"icon\": {\n              \"light\": \"{{getVar 'additional_icon_light'}}\",\n              \"dark\": null\n            }\n          },\n          \"footer\": {\n            \"title\": \"Итого\",\n            \"value\": \"{{divide (getVar 'additional_footer_value') 100}} {{getVar 'currency'}}\"\n          },\n          \"items\": [\n            {{#each (dataRaw 'additional_items')}}\n              {\n                \"key\": \"{{this.key}}\",\n                \"value\": \"{{this.value}}\",\n                \"icon\":\n                  {{#if this.icon}}\n                    {\n                      \"light\": \"{{this.icon.light}}\",\n                      \"dark\": null\n                    }\n                  {{else}}\n                    null\n                  {{/if}}\n              }{{#unless @last}},{{/unless}}\n            {{/each}}\n          ]\n        },\n        \"gni\":\n          {{#if (gt (getVar 'fee') 0)}}\n            {\n                \"terminal_id\": \"EP000000000001\",\n                \"message\": \"1000000000\",\n                \"fiscal_sign\": \"175000000000\",\n                \"date_time\": null,\n                \"qr_link\": \"https://ofd.soliq.uz/epi?t=EP000000000001&r=1000000000&c=20250313131155&s=175000000000\"\n            }\n          {{else}}\n            null\n          {{/if}}\n      },\n    {{/if}}\n  \"state\":\n    {{#if (getVar 'is_error')}}\n      \"error\"\n    {{else}}\n      \"success\"\n    {{/if}},\n  \"error_text\":\n    {{#if (getVar 'is_error')}}\n      \"{{getVar 'error_text'}}\"\n    {{else}}\n      \"\"\n    {{/if}},\n  \"code\": 0,\n  \"_mockoon\": {\n    \"type\": \"{{getVar 'type'}}\",\n    \"state\": \"{{getVar 'state'}}\"\n  }\n}",
          "latency": 0,
          "statusCode": 200,
          "label": "",
          "headers": [],
          "bodyType": "INLINE",
          "filePath": "",
          "databucketID": "",
          "sendFileAsBody": false,
          "rules": [
            {
              "target": "body",
              "modifier": "code",
              "value": "^[0-9]{6}$",
              "invert": false,
              "operator": "regex"
            }
          ],
          "rulesOperator": "OR",
          "disableTemplating": false,
          "fallbackTo404": false,
          "default": false,
          "crudKey": "id",
          "callbacks": []
        }
      ],
      "responseMode": null,
      "streamingMode": null,
      "streamingInterval": 0
    }
  ],
  "rootChildren": [
    {
      "type": "route",
      "uuid": "2cb2e59c-c3a7-45bf-b9ec-c613d9c6d421"
    },
    {
      "type": "route",
      "uuid": "e484904d-0722-4832-b9b9-91ae4694b4c4"
    },
    {
      "type": "route",
      "uuid": "d8300476-ada9-46a4-8ec8-abb964df5d2a"
    }
  ],
  "proxyMode": false,
  "proxyHost": "",
  "proxyRemovePrefix": false,
  "tlsOptions": {
    "enabled": false,
    "type": "CERT",
    "pfxPath": "",
    "certPath": "",
    "keyPath": "",
    "caPath": "",
    "passphrase": ""
  },
  "cors": true,
  "headers": [
    {
      "key": "Content-Type",
      "value": "application/json"
    }
  ],
  "proxyReqHeaders": [
    {
      "key": "",
      "value": ""
    }
  ],
  "proxyResHeaders": [
    {
      "key": "",
      "value": ""
    }
  ],
  "data": [
    {
      "uuid": "f52bd97c-67da-4f64-8ea0-6a0fda6d89c7",
      "id": "joc1",
      "name": "ERROR - No response",
      "documentation": "",
      "value": "{\"mockoon_error\":\"No such response, if you need it, contact TG @khasanshadiyarov\"}"
    },
    {
      "uuid": "b701cea4-8aba-4b8b-ac7e-ecb3c3c0ecf3",
      "id": "o2yy",
      "name": "additional_items",
      "documentation": "",
      "value": ""
    }
  ],
  "callbacks": []
}